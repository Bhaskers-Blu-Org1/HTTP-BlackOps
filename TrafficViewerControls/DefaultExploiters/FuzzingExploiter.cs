using CommonControls;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using TrafficViewerControls.Properties;
using TrafficViewerControls.RequestList;
using TrafficViewerSDK;
using TrafficViewerSDK.Exploiters;
using TrafficViewerSDK.Http;

namespace TrafficViewerControls.DefaultExploiters
{
	public class FuzzingExploiter:IExploiter
	{

		public string Caption
		{
			get { return Resources.Fuzzer; }
		}

		public void Execute(ITrafficDataAccessor curDataAccessor, 
			List<TVRequestInfo> selectedRequests, 
			IHttpClientFactory curHttpClientFactory)
		{
			if (selectedRequests.Count < 1)
			{
				ErrorBox.ShowDialog(Resources.SelectOneRequest);
				return;
			}

			Fuzzer fuzzer = new Fuzzer();
			fuzzer.Requests = selectedRequests;
			fuzzer.DataAccessor = curDataAccessor;
			fuzzer.Show();
			

		}
	}
}
